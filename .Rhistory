knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
library(caret)
library(lattice)
library(gbm)
grid <- expand.grid(.n.trees=c(5),.interaction.depth=6,.shrinkage=c(0.1,0.3,0.5),.n.minobsinnode=5)
set.seed(123)
fit.gbm <- train(y~., data=df, method="gbm", metric=metric, trControl=control, verbose=FALSE,tuneGrid =grid)
library(caret)
library(lattice)
library(gbm)
grid <- expand.grid(.n.trees=c(5),.interaction.depth=6,.shrinkage=c(0.1,0.3,0.5),.n.minobsinnode=5)
set.seed(123)
fit.gbm <- train(Survived~., data=df, method="gbm", metric=metric, trControl=control, verbose=FALSE,tuneGrid =grid)
library(caret)
library(lattice)
library(gbm)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.n.trees=c(5),.interaction.depth=6,.shrinkage=c(0.1,0.3,0.5),.n.minobsinnode=5)
set.seed(123)
fit.gbm <- train(Survived~., data=df, method="gbm", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
plot(fit.gbm)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(caret)
library(lattice)
library(gbm)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.n.trees=c(5),.interaction.depth=6,.shrinkage=c(0.1,0.3,0.5),.n.minobsinnode=5)
set.seed(123)
fit.gbm <- train(Survived~., data=df, method="gbm", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
plot(fit.gbm)
pred <- predict(fit.gbm,test)
table(pred,test$Survived)
pred <- predict(fit.gbm,test)
new_df <-read.csv('Titanic/test.csv',na.strings = "")
ids<- new_df$PassengerId
new_df$Pclass<- as.factor(new_df$Pclass)
new_df<- new_df[,-c(1,3,8)]
fit.c50$xlevels[["Cabin"]] <- union(fit.c50$xlevels[["Cabin"]], levels(new_df$Cabin))
fit.gbm$xlevels[["Cabin"]] <- union(fit.gbm$xlevels[["Cabin"]], levels(new_df$Cabin))
new_pred<- predict(fit.gbm,new_df,na.action = na.pass)
res <- cbind(PassengerId=ids,Survived=as.character(new_pred))
write.csv(res,file="Titanic/gbm.csv",row.names = F)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(caret)
library(lattice)
library(gbm)
control <- trainControl(method="cv", number=5)
set.seed(123)
fit.rf <- train(Survived~., data=df, method="rf",ntree = 10,  metric="Accuray", trControl=control,tuneGrid=expand.grid(.mtry=c(5)))
library(caret)
library(lattice)
library(gbm)
control <- trainControl(method="cv", number=5)
set.seed(123)
fit.rf <- train(Survived~., data=df, method="rf",ntree = 10,  metric="Accuray", trControl=control,tuneGrid=expand.grid(.mtry=c(5)), na.action = na.pass)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
install.packages("randomForest")
library(randomForest)
fit <- randomForest(y ~ .,data=df,ntree=30)
install.packages("randomForest")
knitr::opts_chunk$set(echo = TRUE)
install.packages("randomForest")
library(randomForest)
fit <- randomForest(Survived ~ .,data=df,ntree=30)
#install.packages("randomForest")
library(randomForest)
control <- trainControl(method="cv", number=5)
library(caret)
library(lattice)
library(randomForest)
control <- trainControl(method="cv", number=5)
set.seed(123)
fit.rf <- train(Survived~., data=df, method="rf",ntree = 10,  metric="Accuray", trControl=control,tuneGrid=expand.grid(.mtry=c(5)), na.action = na.pass)
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
fit.rf1 <- train(Survived~., data=df, method="rf",ntree = 10,
metric='ROC',
trControl=trainControl(method="cv",
number=5,
savePredictions="final",
summaryFunction = twoClassSummary,
classProbs = TRUE),
tuneGrid=expand.grid(.mtry=c(5)))
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
fit.rf1 <- train(Survived~., data=df, method="rf",ntree = 10,
metric='ROC',
trControl=trainControl(method="cv",
number=5,
savePredictions="final",
summaryFunction = twoClassSummary,
classProbs = TRUE),
tuneGrid=expand.grid(.mtry=c(5)), na.action=na.pass)
library(caret)
library(lattice)
library(randomForest)
control <- trainControl(method="cv", number=5)
set.seed(123)
fit.rf <- train(Survived~., data=df, method="rf",ntree = 10,  metric="Accuray", trControl=control,tuneGrid=expand.grid(.mtry=c(5)), na.action = na.pass)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
fit.rf1 <- train(Survived~., data=df, method="rf",ntree = 10,
metric='ROC',
trControl=trainControl(method="cv",
number=5,
savePredictions="final",
summaryFunction = twoClassSummary,
classProbs = TRUE),
tuneGrid=expand.grid(.mtry=c(5)), na.action=na.pass)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid)
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass
library(caret)
library(lattice)
library(randomForest)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
library(caret)
library(lattice)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuracy", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
boosting_results <- resamples(list(c5.0=fit.c50, gbm=fit.gbm,xgb=fit.xgb))
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(caret)
library(lattice)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuracy", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
new_df <-read.csv('Titanic/test.csv',na.strings = "")
ids<- new_df$PassengerId
new_df$Pclass<- as.factor(new_df$Pclass)
new_df<- new_df[,-c(1,3,8)]
fit.xgb$xlevels[["Cabin"]] <- union(fit.xgb$xlevels[["Cabin"]], levels(new_df$Cabin))
new_pred<- predict(fit.xgb,new_df,na.action = na.pass)
res <- cbind(PassengerId=ids,Survived=as.character(new_pred))
write.csv(res,file="Titanic/xgb.csv",row.names = F)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'C:\\Users\\Tal\\Desktop\\Titanic\\Titanic')
getwd()
df <- read.csv("Titanic/train.csv",na.strings = "")
str(df)
df$Survived<- as.factor(df$Survived)
df$Pclass<- as.factor(df$Pclass)
summary(df)
df <- df[,-c(1,4,9)]
cols<- 1:dim(df)[2]
factors <- cols[sapply(df,is.factor)]
numerics <- cols[!sapply(df,is.factor)]
#install.packages("tidyr")
library(tidyr)
df_tidy_factors<-gather(df[,factors],"feature","value",-1)
df_tidy_numerics<-gather(cbind(Survived=df[,1],df[,numerics]),"feature","value",-1)
#install.packages("ggplot2")
library(ggplot2)
qplot(x=value,data=df_tidy_factors,fill=Survived) + facet_grid(~feature,scales="free")
qplot(x=value,data=df_tidy_numerics,fill=Survived) + facet_grid(~feature,scales="free")
indices <- sample(1:nrow(df),nrow(df)*0.7)
train<- df[indices,]
test<- df[-indices,]
library(e1071)
set.seed(13)
nb <- naiveBayes(Survived~.,data = train)
nb_pred <- predict(nb, test, na.action = na.pass)
table(nb_pred,test$Survived)
mean(nb_pred==test$Survived)
library(caret)
library(lattice)
library(xgboost)
set.seed(123)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.nrounds=20,.max_depth=6,.eta=c(0.1,0.3,0.5),.gamma=0.1,.colsample_bytree=0.5,.min_child_weight=0.01,.subsample=0.7)
fit.xgb <- train(Survived~., data=df, method="xgbTree", metric="Accuracy", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
plot(fit.xgb)
library(caret)
library(lattice)
library(gbm)
control <- trainControl(method="cv", number=5)
grid <- expand.grid(.n.trees=c(5),.interaction.depth=6,.shrinkage=c(0.1,0.3,0.5),.n.minobsinnode=5)
set.seed(123)
fit.gbm <- train(Survived~., data=df, method="gbm", metric="Accuray", trControl=control, verbose=FALSE,tuneGrid =grid, na.action=na.pass)
plot(fit.gbm)
new_df <-read.csv('Titanic/test.csv',na.strings = "")
ids<- new_df$PassengerId
new_df$Pclass<- as.factor(new_df$Pclass)
new_df<- new_df[,-c(1,3,8)]
nb$xlevels[["Cabin"]] <- union(nb$xlevels[["Cabin"]], levels(new_df$Cabin))
fit.xgb$xlevels[["Cabin"]] <- union(fit.xgb$xlevels[["Cabin"]], levels(new_df$Cabin))
fit.gbm$xlevels[["Cabin"]] <- union(fit.gbm$xlevels[["Cabin"]], levels(new_df$Cabin))
new_nb_pred<- predict(nb,new_df,na.action = na.pass)
new_xgb_pred<- predict(fit.xgb,new_df,na.action = na.pass)
new_gbm_pred<- predict(fit.gbm,new_df,na.action = na.pass)
nb_res <- cbind(PassengerId=ids,Survived=as.character(new_nb_pred))
write.csv(res,file="Titanic/naiveBayes.csv",row.names = F)
nb_res <- cbind(PassengerId=ids,Survived=as.character(new_nb_pred))
write.csv(nb_res,file="Titanic/naiveBayes.csv",row.names = F)
xgb_res <- cbind(PassengerId=ids,Survived=as.character(new_xgb_pred))
write.csv(xgb_res,file="Titanic/xgb.csv",row.names = F)
gbm_res <- cbind(PassengerId=ids,Survived=as.character(new_gbm_pred))
write.csv(gbm_res,file="Titanic/gbm.csv",row.names = F)
xgb_pred <- predict(xgb, test, na.action = na.pass)
xgb_pred <- predict(fit.xgb, test, na.action = na.pass)
table(xgb_pred,test$Survived)
mean(xgb_pred==test$Survived)
gbm_pred <- predict(fit.gbm, test, na.action = na.pass)
table(gbm_pred,test$Survived)
mean(gbm_pred==test$Survived)
